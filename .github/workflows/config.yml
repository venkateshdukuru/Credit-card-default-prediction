
name: branch-protection.yml

on:
  push:
    branches: [main]

jobs:
  enforce-branch-rules:
    runs-on: ubuntu-latest
    steps:
      - name: Check for code changes
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
        if: ${{ github.event_name == 'push' }}
      - name: Enforce requirements
        if: ${{ steps.check_code_changes.outputs.code_changes == 'true' }}
        run: |
          if [ ! -f 'code-coverage-report.txt' ]; then
            echo "Code coverage report not found. Please make sure it is generated from a previous workflow and available as an artifact."
            exit 1
          fi
          if [ ! -f 'code-linting-results.txt' ]; then
            echo "Code linting results not found. Please make sure they are generated from a previous workflow and available as an artifact."
            exit 1
          fi
          if [ ! -f 'unit-test-results.txt' ]; then
            echo "Unit test results not found. Please make sure they are generated from a previous workflow and available as an artifact."
            exit 1
         